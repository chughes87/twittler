<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="moment.min.js"></script>
  </head>
  <body>
    <script>
      var add_tweets = function(tweets) {
        var $body = $('body');
        $body.html('');
        for(var i = 0; i < tweets.length; i++){
          var tweet = tweets[i];
          var $line1 = $('<div></div>');
          var $line2 = $('<div></div>');
          var time = moment(tweet.created_at);
          $line1.text('@' + tweet.user + '      ' + time.fromNow());
          $line2.text("\"" + tweet.message + "\"");
          $line2.prependTo($body);
          $line1.prependTo($body);
        }
      }

      var refresh = function(previousCount) {
        var currentCount = streams.home.length;
        if( currentCount > previousCount){
          add_tweets(streams.home);
        }
        return currentCount;
      }

      $(document).ready(function(){
        var tweetCount = 0;
        setInterval(function(){
          tweetCount = refresh(tweetCount);
        }, 300);
      });

    </script>
  </body>
</html>
